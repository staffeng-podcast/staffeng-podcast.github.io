{{- define "main" }}
    {{- with .Site.GetPage "_index.md" }}
        {{- if .Params.homePageIsPost }}
    <h1>{{ .Title }}</h1>
    <h4>{{ .Params.description }}</h4>
    <p class="author-date"><time datetime="{{ .Date }}">{{ .Date.Format "January 2, 2006" }}</time> - {{ .Params.author }}</p>

            {{- if not (.Param "disableAnchoredHeadings") }}

{{ partial "anchored_headings.html" .Content }}

            {{- else }}

{{ .Content }}

            {{- end }}
        {{- else }}
            {{- $subtitle := .Params.subtitle }}
            {{- with .Content }}
    <section>
    <h1 class="smaller">{{ $subtitle }}</h1>
{{ . }}
    </section>
            {{- end }}
        {{- end }}
    {{- end }}

    {{- /* Display posts from 'posts' section without section header */ -}}
    {{- with .Site.GetPage "posts" }}
    <section>
    <ul class="no-decoration">
        {{- range .RegularPages }}
        <li style="list-style: none; margin-bottom: 2em;">
            <div><a href="{{ .Permalink }}">{{ .Title }}</a></div>
            {{- with .Params.key_quote }}
                {{- if reflect.IsSlice . }}
                    <blockquote style="margin: 0.5em 0 0 0; padding-left: 1em; border-left: 3px solid #ccc; font-style: italic;">{{ index . 0 }}</blockquote>
                {{- else }}
                    <blockquote style="margin: 0.5em 0 0 0; padding-left: 1em; border-left: 3px solid #ccc; font-style: italic;">{{ . }}</blockquote>
                {{- end }}
            {{- end }}
            <div><time style="float: right;" datetime="{{ .Date }}">{{ .Date.Format "Jan 02 2006" }}</time></div>
        </li>
        {{- end }}
    </ul>
    </section>
    {{- end }}

    {{- /* Display seasonal sections with headers */ -}}
    {{- range sort (where .Site.Sections "Section" "in" .Site.MainSections) "Weight" }}
    <section>
    <h2>{{ .Title }}</h2>
    {{- with .Content }}
    <div class="section-description">{{ . }}</div>
    {{- end }}
    {{- $sectionPages := where .Site.RegularPages "Section" .Section }}
    {{- if $sectionPages }}
    <h3>Episodes</h3>
    <ul class="no-decoration">
        {{- range $sectionPages }}
        <li style="list-style: none; margin-bottom: 2em;">
            <div><a href="{{ .Permalink }}">{{ .Title }}</a></div>
            {{- with .Params.key_quote }}
                {{- if reflect.IsSlice . }}
                    <blockquote style="margin: 0.5em 0 0 0; padding-left: 1em; border-left: 3px solid #ccc; font-style: italic;">{{ index . 0 }}</blockquote>
                {{- else }}
                    <blockquote style="margin: 0.5em 0 0 0; padding-left: 1em; border-left: 3px solid #ccc; font-style: italic;">{{ . }}</blockquote>
                {{- end }}
            {{- end }}
            <div><time style="float: right;" datetime="{{ .Date }}">{{ .Date.Format "Jan 02 2006" }}</time></div>
        </li>
        {{- end }}
    </ul>
    {{- else }}
    <p><em>This season is in production, episodes are coming soon!</em></p>
    {{- end }}
    </section>
    {{- end }}
{{- end }}
